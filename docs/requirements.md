# 視覚の限界（Eye Measure）要件定義書

> あなたの感覚と頭脳で距離・サイズを当ててみよう

## 1. プロジェクト概要

### 1.1 コンセプト
人間の空間認識能力をテストする推測ゲーム。風景写真内のターゲットまでの「距離」や「サイズ」を推測し、正解との誤差でスコアを競う。錯覚を利用したステージ設計により、シンプルながら奥深いゲーム体験を提供する。

### 1.2 ターゲットユーザー
- カジュアルゲーマー（暇つぶしに手軽に遊びたい層）
- パズル・クイズ好き（知的好奇心を刺激されたい層）
- 競争心のあるユーザー（ランキングで上位を目指したい層）

### 1.3 プラットフォーム
- **Phase 1**: Webブラウザ（PC/モバイル対応）
- **Phase 2**: iOS / Android ネイティブアプリ（将来検討）

---

## 2. ゲームシステム

### 2.1 基本ゲームサイクル

```
[問題提示] → [推測入力] → [判定演出] → [リザルト表示] → [次の問題 or 終了]
```

#### 2.1.1 問題提示フェーズ
| 項目 | 詳細 |
|------|------|
| 表示内容 | 1枚の風景写真 + ターゲット指示 |
| ターゲット指示 | 矢印アイコン + テキスト（例：「あの赤い看板までの距離は？」） |
| 制限時間 | なし（リラックスして推測できる設計） |
| ヒント機能 | オプション：既知サイズのオブジェクトをハイライト表示 |

#### 2.1.2 推測入力フェーズ
| 入力項目 | UI | 範囲 |
|----------|-----|------|
| 距離 | スライダー + 数値入力 | 0.1m〜10,000m（問題により可変） |
| 高さ/幅 | スライダー + 数値入力 | 0.01m〜1,000m（問題により可変） |

**操作性の工夫**:
- スライダーは対数スケール（細かい調整と大きな変更の両方に対応）
- タップで±0.1m / ±1m の微調整ボタン
- ピンチイン/アウトで写真を拡大して詳細確認可能

#### 2.1.3 判定演出フェーズ
| 演出タイプ | 説明 |
|------------|------|
| 横回り込みカメラ | 2D写真が擬似3D空間に変換され、カメラが横に回り込んで奥行きが明らかになる |
| スケール比較 | ターゲットの横に人間シルエット（170cm）を配置して大きさを実感 |
| 距離ライン | カメラ位置からターゲットまでメジャーが伸びるアニメーション |

#### 2.1.4 リザルトフェーズ
| 表示項目 | 詳細 |
|----------|------|
| 正解値 | 実際の距離/サイズ |
| あなたの回答 | 入力した値 |
| 誤差 | 絶対値 + パーセンテージ |
| スコア | 100点満点（誤差に応じて減点） |
| 称号 | 誤差率に応じた称号を付与 |

---

### 2.2 スコアリングシステム

#### 2.2.1 スコア計算式
```
スコア = max(0, 100 - (誤差率 × 係数))

誤差率 = |推測値 - 正解値| / 正解値 × 100

係数はステージ難易度により調整（易:2, 普:1.5, 難:1）
```

#### 2.2.2 称号システム
| 誤差率 | 称号 | 演出 |
|--------|------|------|
| 0% | 🏆 神の目（God's Eye） | 金色エフェクト + 花火 |
| 0.1%〜1% | 👁️ 達人の目（Master Eye） | 銀色エフェクト |
| 1%〜5% | 🎯 鷹の目（Hawk Eye） | 緑色エフェクト |
| 5%〜10% | 👀 良い目（Sharp Eye） | 青色エフェクト |
| 10%〜20% | 👁️‍🗨️ 普通の目（Normal Eye） | 通常表示 |
| 20%以上 | 🙈 節穴（Blind Spot） | コミカルな演出 |

---

### 2.3 ステージ構成（錯覚のテーマ）

#### レベル1：日常の風景（チュートリアル）
- **テーマ**: 既知サイズで感覚を養う
- **例題**:
  - 自動販売機（高さ約183cm）
  - 電柱（高さ約8〜12m）
  - マンホール（直径約60cm）
  - 信号機（高さ約5〜6m）
- **難易度**: ★☆☆☆☆

#### レベル2：空気の罠（大気透視）
- **テーマ**: 大気の状態が距離感を狂わせる
- **例題**:
  - 快晴の山 vs 霧がかった森
  - 夕焼けのシルエット
  - 逆光で見えにくい建物
- **難易度**: ★★☆☆☆

#### レベル3：ミニチュアの罠（相対的スケール）
- **テーマ**: 比較対象がないと大きさがわからない
- **例題**:
  - 本物のビル vs ジオラマ模型
  - チルトシフト写真（実物がミニチュアに見える）
  - 巨大な果物オブジェ
- **難易度**: ★★★☆☆

#### レベル4：ARの罠（影と光の操作）
- **テーマ**: 視覚の手がかりを意図的に排除
- **例題**:
  - 影を消した合成画像
  - 影の向きが逆の画像
  - 浮遊しているように見える物体
- **難易度**: ★★★★☆

#### レベル5：錯視の罠（幾何学的錯覚）
- **テーマ**: 古典的な錯視を利用
- **例題**:
  - エイムズの部屋
  - ポンゾ錯視を利用した道路
  - 強制遠近法の建築物
- **難易度**: ★★★★★

---

## 3. ゲームモード

### 3.1 モード一覧

| モード | 説明 | 解放条件 |
|--------|------|----------|
| ストーリーモード | レベル順にステージをクリア | 初期解放 |
| フリープレイ | クリア済みステージを自由にプレイ | 該当レベルクリア後 |
| デイリーチャレンジ | 毎日更新される3問セット | レベル1クリア後 |
| タイムアタック | 10問を最速でクリア | レベル3クリア後 |
| ワールドツアー | 世界の名所を巡るスペシャルモード | レベル5クリア後 |

### 3.2 ストーリーモード詳細
- 各レベル10ステージ × 5レベル = 合計50ステージ
- 各ステージで★3評価（平均スコア90以上で★3）
- 次レベル解放条件：前レベルで合計★20以上獲得

---

## 4. 中毒性を高める要素

### 4.1 ピタリ賞演出
- **条件**: 誤差1%以内
- **演出内容**:
  - 画面全体が金色に光る
  - 紙吹雪エフェクト
  - 特別なサウンドエフェクト
  - SNSシェアボタンを目立たせる
  - 「ピタリ賞達成者は全体の0.3%」などの希少性表示

### 4.2 ランキングシステム
| ランキング種別 | 説明 |
|----------------|------|
| 総合スコア | 全ステージ累計スコア |
| デイリー | その日のデイリーチャレンジ順位 |
| ステージ別 | 各ステージのベストスコア |
| 偏差値表示 | 「あなたの空間認識能力は上位○%」 |

### 4.3 コレクション機能（図鑑）
正解した被写体を「図鑑」に登録：

| カテゴリ | 例 |
|----------|-----|
| 日本の名所 | 東京タワー、スカイツリー、富士山、大阪城 |
| 世界の名所 | 自由の女神、エッフェル塔、ピラミッド、万里の長城 |
| 乗り物 | 飛行機、新幹線、大型客船、戦車 |
| 生き物 | シロナガスクジラ、キリン、象、コンドル |
| 建造物 | ダム、風力発電機、石油プラットフォーム |

図鑑には以下を表示：
- 写真
- 実際のサイズ
- 豆知識
- あなたの推測履歴（初回推測値を記録）

### 4.4 実績（アチーブメント）
| 実績名 | 条件 |
|--------|------|
| はじめの一歩 | 最初のステージをクリア |
| 神の目の持ち主 | ピタリ賞を10回達成 |
| コレクター | 図鑑を50%埋める |
| 世界を巡る目 | ワールドツアーを完走 |
| 上位1% | 偏差値70以上を達成 |
| 連続正解王 | 10問連続で誤差5%以内 |

---

## 5. UI/UX設計

### 5.1 画面遷移図
```
[タイトル画面]
    │
    ├──[モード選択]
    │      ├── ストーリーモード → [レベル選択] → [ステージ選択] → [ゲーム画面]
    │      ├── フリープレイ → [ステージ選択] → [ゲーム画面]
    │      ├── デイリーチャレンジ → [ゲーム画面]
    │      └── タイムアタック → [ゲーム画面]
    │
    ├──[図鑑]
    │      └── [カテゴリ選択] → [アイテム詳細]
    │
    ├──[ランキング]
    │      └── [カテゴリ選択] → [詳細ランキング]
    │
    ├──[実績]
    │
    └──[設定]
```

### 5.2 ゲーム画面レイアウト

```
┌─────────────────────────────────────┐
│  ≡  LEVEL 2-3    🏆 Score: 850     │  ← ヘッダー
├─────────────────────────────────────┤
│                                     │
│                                     │
│         [  風景写真エリア  ]         │
│                                     │
│              ↓ ターゲット           │
│                                     │
├─────────────────────────────────────┤
│  🎯 あの電柱までの距離は？           │  ← 問題文
├─────────────────────────────────────┤
│                                     │
│  距離: [━━━━━━━●━━━] 15.0 m        │  ← スライダー
│        [-0.1] [-1]  [+1] [+0.1]    │  ← 微調整ボタン
│                                     │
│  高さ: [━━━●━━━━━━━━] 8.5 m         │
│        [-0.1] [-1]  [+1] [+0.1]    │
│                                     │
├─────────────────────────────────────┤
│          [ 回答する！ ]              │  ← 決定ボタン
└─────────────────────────────────────┘
```

### 5.3 カラースキーム
| 用途 | カラー |
|------|--------|
| プライマリ | #3B82F6（ブルー） |
| セカンダリ | #10B981（グリーン） |
| アクセント | #F59E0B（オレンジ） |
| 背景 | #1F2937（ダークグレー） |
| テキスト | #F9FAFB（ホワイト） |
| エラー | #EF4444（レッド） |

---

## 6. 技術要件

### 6.1 フロントエンド
| 項目 | 技術選定 |
|------|----------|
| フレームワーク | React 18 + TypeScript |
| スタイリング | Tailwind CSS |
| アニメーション | Framer Motion |
| 状態管理 | Zustand |
| 3D演出 | Three.js（判定演出用） |

### 6.2 バックエンド
| 項目 | 技術選定 |
|------|----------|
| ランタイム | Node.js |
| フレームワーク | Express or Hono |
| データベース | PostgreSQL（ユーザーデータ） |
| キャッシュ | Redis（ランキング） |
| 認証 | Firebase Auth or Auth0 |

### 6.3 インフラ
| 項目 | 技術選定 |
|------|----------|
| ホスティング | Vercel（フロント） / Railway（バック） |
| CDN | Cloudflare |
| 画像ストレージ | Cloudflare R2 or AWS S3 |

---

## 7. データ設計

### 7.1 ステージデータ（JSON）
```json
{
  "stageId": "L2-03",
  "level": 2,
  "theme": "大気透視",
  "image": "https://cdn.example.com/stages/l2-03.jpg",
  "question": {
    "text": "霧の向こうに見える山頂までの距離は？",
    "targetPosition": { "x": 0.6, "y": 0.3 },
    "measurements": [
      { "type": "distance", "value": 2400, "unit": "m" }
    ]
  },
  "hints": [
    { "text": "手前の木は高さ約15mです", "position": { "x": 0.2, "y": 0.7 } }
  ],
  "difficulty": 2,
  "collectionItem": {
    "id": "mt-takao",
    "name": "高尾山",
    "category": "日本の名所"
  }
}
```

### 7.2 ユーザーデータ
```json
{
  "userId": "user-123",
  "displayName": "VisualMaster",
  "stats": {
    "totalScore": 45680,
    "stagesCleared": 35,
    "perfectCount": 12,
    "percentile": 92.5
  },
  "progress": {
    "currentLevel": 3,
    "starsEarned": { "L1": 28, "L2": 25, "L3": 8 }
  },
  "collection": ["tokyo-tower", "mt-fuji", "statue-of-liberty"],
  "achievements": ["first-step", "gods-eye-10"]
}
```

---

## 8. 開発ロードマップ

### Phase 1: MVP（4週間）
- [ ] 基本ゲームサイクル実装
- [ ] レベル1（10ステージ）作成
- [ ] スコアリングシステム
- [ ] 基本UI実装

### Phase 2: コア機能（3週間）
- [ ] レベル2〜3追加（20ステージ）
- [ ] 判定演出（3Dカメラ回り込み）
- [ ] 称号システム
- [ ] ローカルストレージでの進捗保存

### Phase 3: ソーシャル機能（3週間）
- [ ] ユーザー認証
- [ ] ランキングシステム
- [ ] デイリーチャレンジ
- [ ] SNSシェア機能

### Phase 4: 拡張コンテンツ（4週間）
- [ ] レベル4〜5追加（20ステージ）
- [ ] 図鑑・コレクション機能
- [ ] 実績システム
- [ ] ワールドツアーモード

### Phase 5: 最適化・リリース（2週間）
- [ ] パフォーマンス最適化
- [ ] アクセシビリティ対応
- [ ] 多言語対応（日/英）
- [ ] ベータテスト・バグ修正

---

## 9. KPI（成功指標）

| 指標 | 目標値 |
|------|--------|
| DAU（日間アクティブユーザー） | 10,000+ |
| 継続率（7日） | 30%以上 |
| 平均プレイ時間/日 | 10分以上 |
| SNSシェア率 | 5%以上 |
| ストアレビュー | 4.5★以上 |

---

## 10. リスクと対策

| リスク | 対策 |
|--------|------|
| 画像著作権問題 | フリー素材 + オリジナル撮影で対応 |
| ネタ切れ | ユーザー投稿機能を将来追加 |
| チート対策 | サーバーサイドでスコア検証 |
| 飽きられる | 定期的なステージ追加 + イベント開催 |

---

## 11. 将来の拡張案

1. **マルチプレイヤーモード**: 2人で同時に推測し、より正確な方が勝ち
2. **ARモード**: スマホカメラで現実世界の物体を推測
3. **ユーザー投稿ステージ**: 自分で撮影した写真を問題として投稿
4. **教育機関向けライセンス**: 空間認識トレーニング教材として提供
5. **VRモード**: より没入感のある体験

---

*最終更新: 2026-01-31*
